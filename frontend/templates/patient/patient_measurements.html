{% extends "patient/base_patient.html" %}

{% block title %}Medidas — PredictHealth{% endblock %}

{% block breadcrumb %}Medidas{% endblock %}

{% block head_extra %}
<!-- Bootstrap CSS para alertas -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
<script src="{{ url_for('static', filename='js/charts.js') }}" defer></script>
{% endblock %}

{% block content %}
<main class="container">
    <div class="card">
      <h1>Registrar medidas de salud</h1>
      <form id="measurementsForm" method="POST">
        <label>Presión arterial (Sistólica)
          <input type="number" name="bp_systolic" required min="50" max="250" placeholder="120">
        </label>
        <label>Presión arterial (Diastólica)
          <input type="number" name="bp_diastolic" required min="30" max="150" placeholder="80">
        </label>
        <label>Glucosa (mg/dL)
          <input type="number" name="glucose" required min="30" max="600" placeholder="95">
        </label>
        <button class="btn primary" type="submit" data-original-text="Guardar medidas">Guardar medidas</button>
      </form>
    </div>

    <div class="card">
      <h2>Tendencias</h2>
      <canvas id="measurementsChart" height="180"></canvas>
    </div>
  </main>
{% endblock %}

{% block scripts_extra %}
<script src="{{ url_for('static', filename='js/app.js') }}"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // Configurar gráfico de mediciones
  document.addEventListener('DOMContentLoaded', function() {
    const ctx = document.getElementById('measurementsChart').getContext('2d');
    window.measurementsChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'],
        datasets: [{
          label: 'Presión Sistólica',
          data: [120, 118, 122, 119, 121, 120],
          borderColor: 'rgb(75, 192, 192)',
          tension: 0.1
        }, {
          label: 'Presión Diastólica',
          data: [80, 78, 82, 79, 81, 80],
          borderColor: 'rgb(255, 99, 132)',
          tension: 0.1
        }, {
          label: 'Glucosa',
          data: [95, 92, 98, 94, 96, 95],
          borderColor: 'rgb(54, 162, 235)',
          tension: 0.1
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: false
          }
        }
      }
    });
  });
</script>
{% endblock %}